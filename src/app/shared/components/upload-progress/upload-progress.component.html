@if (uploadService.hasActiveUploads()) {
  <div class="upload-progress-container" 
       [class.expanded]="isExpanded()"
       animate.enter="slide-up">
    
    <!-- Always visible header -->
    <div class="upload-header" (click)="toggleExpand()">
      <div class="header-left">
        <mat-icon class="expand-icon" [class.rotated]="isExpanded()">
          expand_less
        </mat-icon>
        <span class="upload-title">
          @if (uploadService.uploadingCount() > 0) {
            {{ uploadService.uploadingCount() }} 
            {{ uploadService.uploadingCount() === 1 ? 'video uploading' : 'videos uploading' }}
          } @else {
            Uploads ({{ uploadService.uploadCount() }})
          }
        </span>
      </div>
      
      <div class="header-actions">    
        @if (uploadService.uploadedCount() > 0 || uploadService.errorCount() > 0) {
          <button mat-icon-button 
                  (click)="uploadService.clearCompleted(); $event.stopPropagation()"
                  class="clear-btn"
                  matTooltip="Clear completed">
            <mat-icon>clear_all</mat-icon>
          </button>
        }
      </div>
    </div>

    <!-- Upload list (visible when expanded) -->
    @if (isExpanded()) {
      <div class="upload-list" animate.enter="expand-down">
        @for (upload of uploadService.activeUploads(); track upload.tempId) {
          <div class="upload-item" 
               [class.completed]="upload.status === 'uploaded'"
               [class.failed]="upload.status === 'error'"
               animate.enter="slide-fade-in"
               animate.leave="slide-fade-out">
            <div class="upload-info">
              <mat-icon [class]="'status-icon ' + getStatusColor(upload.status)">
                {{ getStatusIcon(upload.status) }}
              </mat-icon>
              
              <div class="upload-details">
                <div class="upload-name">{{ upload.title || upload.fileName }}</div>
                <div class="upload-status">
                  @if (upload.status === 'uploaded') {
                    <span class="success">✓ Upload complete</span>
                  } @else if (upload.status === 'error') {
                    <span class="error">✗ {{ upload.errorMessage || 'Error' }}</span>
                  } @else {
                    <span>Uploading: {{ upload.progress }}%</span>
                  }
                </div>
              </div>
            </div>

            <!-- Progress bar -->
            @if (upload.status !== 'error') {
              <mat-progress-bar 
                mode="determinate"
                [value]="upload.progress"
                [color]="upload.status === 'uploaded' ? 'accent' : 'primary'">
              </mat-progress-bar>
            }
          </div>
        }
      </div>
    }
  </div>
}
